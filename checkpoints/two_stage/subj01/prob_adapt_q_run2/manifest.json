{
  "args": {
    "config": "configs/experiments/probabilistic/stage1/prob_adapt_q.yaml",
    "paper_mode": true,
    "index_root": "data/indices/nsd_index",
    "subject": "subj01",
    "clip_cache": "outputs/clip_cache/clip.parquet",
    "allow_fallback_index": false,
    "skip_index_validation": false,
    "allow_skips": false,
    "num_workers": 0,
    "use_preproc": true,
    "pca_k": 512,
    "preproc_dir": "outputs/preproc",
    "latent_dim": 512,
    "n_blocks": 4,
    "dropout": 0.3,
    "head_type": "linear",
    "head_hidden": 512,
    "self_supervised": false,
    "ssl_objective": "masked",
    "ssl_epochs": 20,
    "mask_ratio": 0.3,
    "noise_std": 0.1,
    "freeze_stage1": false,
    "stage2_epochs": null,
    "mse_weight": 0.3,
    "cosine_weight": 0.3,
    "info_nce_weight": 0.4,
    "temperature": 0.05,
    "multi_layer": true,
    "multilayer_cache": "cache/clip_embeddings/nsd_clipcache_multilayer.parquet",
    "streaming": false,
    "predict_text_clip": false,
    "text_clip_cache": "cache/clip_embeddings/text_clip.parquet",
    "text_clip_weight": 0.3,
    "probabilistic": true,
    "kl_weight": 0.0001,
    "kl_anneal_epochs": 10,
    "use_phase4": false,
    "structural_dim": 256,
    "semantic_dim": 512,
    "structural_weight": 1.0,
    "semantic_weight": 1.0,
    "lr": 0.001,
    "wd": 0.0001,
    "batch_size": 4,
    "epochs": 50,
    "patience": 10,
    "device": "auto",
    "seed": 42,
    "limit": null,
    "checkpoint_dir": "checkpoints/two_stage/subj01/prob_adapt_q_run2",
    "save_name": null,
    "output_dir": "checkpoints/two_stage/subj01/prob_adapt_q_run2",
    "reliability_threshold": 0.1,
    "enable_reliability_filter": true,
    "enable_pca": true,
    "use_roi": false,
    "scaler_type": "standard",
    "mask_threshold": 0.0,
    "remove_mean": true,
    "reliability_mode": "hard_threshold",
    "reliability_curve": "sigmoid",
    "reliability_temperature": 0.1,
    "infonce_weight": 0.0,
    "infonce_temperature": 0.07,
    "infonce_normalize": true,
    "nll_weight": 1.0,
    "cosine_aux_weight": 0.1,
    "variance_penalty_weight": 0.01,
    "nll_reduction": "mean",
    "logvar_min": -8.0,
    "logvar_max": 2.0,
    "variance_floor": 1e-06,
    "gradient_clip": 1.0,
    "mixed_precision": false,
    "lr_scheduler": "cosine",
    "warmup_epochs": 5,
    "min_lr": 1e-06,
    "label_smoothing": 0.0,
    "save_best_only": true,
    "save_frequency": 5,
    "early_stop_patience": 15,
    "uncertainty": "diag",
    "predict_logvar": true,
    "clip_space": "normalized"
  },
  "config": {
    "dataset": {
      "subject": "subj01",
      "subject_num": 1,
      "max_trials": 30000,
      "train_ratio": 0.8,
      "val_ratio": 0.1,
      "test_ratio": 0.1,
      "index_dir": "data/indices/nsd_index",
      "num_workers": 4,
      "pin_memory": true,
      "prefetch_factor": 2
    },
    "preprocessing": {
      "reliability_threshold": 0.1,
      "enable_reliability_filter": true,
      "pca_k": 512,
      "enable_pca": true,
      "use_roi": false,
      "scaler_type": "standard",
      "mask_threshold": 0.0,
      "remove_mean": true,
      "reliability_mode": "hard_threshold",
      "reliability_curve": "sigmoid",
      "reliability_temperature": 0.1
    },
    "clip": {
      "model_name": "ViT-B/32",
      "pretrained": "openai",
      "embedding_dim": 512,
      "device": "cuda",
      "batch_size": 64,
      "extract_layers": [
        4,
        8,
        12
      ],
      "layer_dims": {
        "layer_4": 768,
        "layer_8": 768,
        "layer_12": 768,
        "final": 512
      }
    },
    "clip_embedding": {
      "space": "normalized",
      "normalize_targets": true,
      "normalize_predictions": true
    },
    "training": {
      "device": "cuda",
      "seed": 42,
      "gradient_clip": 1.0,
      "mixed_precision": false,
      "lr_scheduler": "cosine",
      "warmup_epochs": 5,
      "min_lr": 1e-06,
      "weight_decay": 0.0001,
      "label_smoothing": 0.0,
      "save_best_only": true,
      "save_frequency": 5,
      "early_stop_patience": 15
    },
    "loss": {
      "cosine_weight": 0.0,
      "mse_weight": 0.0,
      "infonce_weight": 0.0,
      "infonce_temperature": 0.07,
      "infonce_normalize": true,
      "nll_weight": 1.0,
      "cosine_aux_weight": 0.1,
      "variance_penalty_weight": 0.01,
      "nll_reduction": "mean",
      "logvar_min": -8.0,
      "logvar_max": 2.0,
      "variance_floor": 1e-06
    },
    "evaluation": {
      "metrics": [
        "mse",
        "cosine_similarity",
        "pearson_correlation",
        "l1_distance"
      ],
      "retrieval_top_k": [
        1,
        5,
        10,
        50
      ],
      "log_interval": 10,
      "eval_interval": 1,
      "calibration_bins": 10,
      "calibration_error_metric": "cosine"
    },
    "decoder": {
      "type": "probabilistic",
      "uncertainty": "diag",
      "predict_logvar": true,
      "logvar_min": -8.0,
      "logvar_max": 2.0,
      "variance_floor": 1e-06
    },
    "inference": {
      "sampling_policy": "adaptive_quantile",
      "K_base": 8,
      "K_set": [
        1,
        2,
        4,
        8,
        16
      ],
      "enforce_budget": true,
      "selection_rule": "likelihood",
      "adaptive_quantile": {
        "quantiles": [
          0.0,
          0.1,
          0.3,
          0.6,
          0.85,
          1.0
        ],
        "K_bins": [
          16,
          8,
          4,
          2,
          1
        ],
        "budget_correction": "deterministic"
      },
      "adaptive_mapping": {
        "thresholds": [
          0.2,
          0.4,
          0.6,
          0.8
        ],
        "K_values": [
          1,
          2,
          4,
          8,
          16
        ]
      }
    },
    "diffusion": {
      "model_id": "stabilityai/stable-diffusion-2-1",
      "num_inference_steps": 150,
      "guidance_scale": 7.5,
      "scheduler": "euler",
      "eta": 0.0,
      "output_size": 768,
      "dtype": "float32",
      "enable_attention_slicing": true,
      "enable_vae_slicing": true,
      "enable_cpu_offload": false
    },
    "paths": {
      "output_dir": "outputs",
      "cache_dir": "cache",
      "checkpoint_dir": "checkpoints",
      "log_dir": "logs",
      "report_dir": "outputs/reports",
      "s3_bucket": "natural-scenes-dataset",
      "s3_region": "us-east-2",
      "s3_anon": true
    },
    "logging": {
      "level": "INFO",
      "format": "%(asctime)s [%(levelname)s] %(name)s: %(message)s",
      "date_format": "%Y-%m-%d %H:%M:%S",
      "use_wandb": false,
      "use_tensorboard": false
    },
    "metadata": {
      "config_version": "3.0",
      "description": "Base configuration with sensible defaults",
      "paper_reference": "Bachelor Thesis 2025",
      "dataset_reference": "Allen et al., 2022, Nature Neuroscience"
    },
    "experiment": {
      "name": "prob_adapt_q",
      "description": "Probabilistic decoder + adaptive quantile allocator, fixed compute budget",
      "tags": [
        "stage1",
        "probabilistic",
        "adaptive_quantile"
      ]
    }
  },
  "prob_cfg": {
    "decoder_type": "probabilistic",
    "uncertainty": "diag",
    "predict_logvar": true,
    "logvar_min": -8.0,
    "logvar_max": 2.0,
    "variance_floor": 1e-06,
    "clip_space": "normalized",
    "nll_weight": 1.0,
    "cosine_aux_weight": 0.1,
    "variance_penalty_weight": 0.01,
    "nll_reduction": "mean"
  },
  "paper_mode": true,
  "run_dir": "checkpoints/two_stage/subj01/prob_adapt_q_run2"
}